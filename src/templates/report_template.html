<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>SEO-отчёт: {{ card.overview.title if card.overview and card.overview.title else 'Без названия' }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f9f9f9; }
        h1, h2, h3 { color: #2d3a4a; }
        .score { font-size: 2em; color: #2e7d32; }
        .recommendations { background: #fffbe7; padding: 15px; border-radius: 8px; }
        .card-info, .section { background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        ul { margin: 0 0 0 20px; }
        table { border-collapse: collapse; width: 100%; background: #fff; margin-bottom: 20px; }
        th, td { border: 1px solid #e0e0e0; padding: 8px 12px; text-align: left; }
        th { background: #f0f0f0; }
        .ok { color: #2e7d32; font-weight: bold; }
        .bad { color: #c62828; font-weight: bold; }
        .photo-thumb { max-width: 120px; max-height: 90px; margin: 2px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>SEO-анализ страницы Яндекс.Карт</h1>
    <div class="card-info">
        <h2>{{ card.overview.title if card.overview and card.overview.title else 'Без названия' }}</h2>
        <p><b>Ссылка:</b> <a href="{{ card.overview.site if card.overview and card.overview.site else '#' }}">{{ card.overview.site if card.overview and card.overview.site else 'Нет сайта' }}</a></p>
    </div>
    <div class="score">
        <b>Оценка SEO:</b> {{ analysis.score }} / 100
    </div>
    <div class="recommendations">
        <h2>Рекомендации по улучшению</h2>
        <ul>
            {% for rec in analysis.recommendations %}
            <li>{{ rec }}</li>
            {% endfor %}
        </ul>
    </div>
    <div class="section">
        <h2>Обзор</h2>
        {% if card.overview %}
        <table>
            <tr><th>Название</th><td>{{ card.overview.title | default('') }}</td></tr>
            <tr><th>Рейтинг</th><td>{{ card.overview.rating | default('') }}</td></tr>
            <tr><th>Количество оценок</th><td>{{ card.overview.reviews_count | default('') }}</td></tr>
            <tr><th>Ближайшее метро</th>
                <td>{{ card.nearest_metro.name }}{% if card.nearest_metro.distance %} ({{ card.nearest_metro.distance }}){% endif %}</td>
            </tr>
            <tr><th>Ближайшая остановка</th>
                <td>{{ card.nearest_stop.name }}{% if card.nearest_stop.distance %} ({{ card.nearest_stop.distance }}){% endif %}</td>
            </tr>
            <tr><th>Адрес</th><td>{{ card.overview.address | default('') }}</td></tr>
            <tr><th>Телефон</th><td>{{ card.overview.phone | default('') }}</td></tr>
            <tr><th>Сайт</th><td><a href="{{ card.overview.site | default('#') }}">{{ card.overview.site | default('Нет сайта') }}</a></td></tr>
            <tr><th>Описание</th><td>{{ card.overview.description | default('') }}</td></tr>
            <tr><th>Категории</th><td>{{ card.overview.categories|join(', ') if card.overview.categories else '' }}</td></tr>
            <tr><th>Часы работы</th><td>{{ card.overview.hours | default('') }}</td></tr>
        </table>
        {% else %}<p>Нет данных</p>{% endif %}
    </div>
    <div class="section">
        <h2>Товары и услуги</h2>
        {% if card.services %}
        <table>
            <tr><th>Категория</th><th>Название</th><th>Описание</th><th>Цена</th><th>Фото</th></tr>
            {% for s in card.services %}
            <tr>
                <td>{{ s.category | default('') }}</td>
                <td>{{ s.name | default('') }}</td>
                <td>{{ s.description | default('') }}</td>
                <td>{{ s.price | default('') }}</td>
                <td>{% if s.photo %}<img src="{{ s.photo }}" class="photo-thumb">{% endif %}</td>
            </tr>
            {% endfor %}
        </table>
        {% else %}<p>Нет данных</p>{% endif %}
    </div>
    <div class="section">
        <h2>Новости</h2>
        {% if card.news %}
        <table>
            <tr><th>Заголовок</th><th>Текст</th><th>Дата</th><th>Фото</th></tr>
            {% for n in card.news %}
            <tr>
                <td>{{ n.title | default('') }}</td>
                <td>{{ n.text | default('') }}</td>
                <td>{{ n.date | default('') }}</td>
                <td>{% if n.photo %}<img src="{{ n.photo }}" class="photo-thumb">{% endif %}</td>
            </tr>
            {% endfor %}
        </table>
        {% else %}<p>Нет новостей</p>{% endif %}
    </div>
    <div class="section">
        <h2>Фото</h2>
        {% if card.photos and card.photos.photos %}
            {% for p in card.photos.photos %}
                <img src="{{ p }}" class="photo-thumb">
            {% endfor %}
            <p>Всего фото: {{ card.photos.photos_count }}</p>
        {% else %}<p>Нет фото</p>{% endif %}
    </div>
    <div class="section">
        <h2>Отзывы</h2>
        {% if card.reviews %}
            <p>Средняя оценка: <b>{{ card.reviews.rating | default('') }}</b> | Количество отзывов: <b>{{ card.reviews.reviews_count | default('') }}</b></p>
            {% if card.reviews.items %}
            <table>
                <tr><th>Автор</th><th>Дата</th><th>Оценка</th><th>Текст</th><th>Ответ организации</th></tr>
                {% for r in card.reviews.items %}
                <tr>
                    <td>{{ r.author | default('') }}</td>
                    <td>{{ r.date | default('') }}</td>
                    <td>{{ r.score | default('') }}</td>
                    <td>{{ r.text | default('') }}</td>
                    <td>{{ r.org_reply | default('') }}</td>
                </tr>
                {% endfor %}
            </table>
            {% else %}<p>Нет отзывов</p>{% endif %}
        {% else %}
            <p>Нет отзывов</p>
        {% endif %}
    </div>
    <div class="section">
        <h2>Особенности</h2>
        {% if card.features %}
        <table>
            <tr><th>Параметр</th><th>Значение</th></tr>
            {% for f in card.features %}
            <tr>
                <td>{{ f.name | default('') }}</td>
                <td>{{ f.value | default('') }}</td>
            </tr>
            {% endfor %}
        </table>
        {% else %}<p>Нет данных</p>{% endif %}
    </div>
</body>
</html> 